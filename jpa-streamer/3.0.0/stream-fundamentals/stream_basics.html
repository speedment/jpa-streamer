<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Stream Fundamentals :: JPAStreamer</title>
    <link rel="prev" href="../predicates/combining-predicates.html">
    <link rel="next" href="intermediate_operations.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
<link rel="stylesheet" href="../../../_/css/search.css">
  </head>
  <body class="article">
<header class="header" role="banner">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item logo" href="https://speedment.github.io/jpa-streamer/"></a>
            <div class="navbar-item" style="background: none">
                <input id="search-input" type="text" placeholder="Search docs...">
            </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
          <a class="navbar-item" href="https://speedment.github.io/jpa-streamer/">Home</a>
          <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="#">Resources</a>
              <div class="navbar-dropdown">
                  <a class="navbar-item" href="https://gitter.im/speedment/jpa-streamer">Gitter Chat</a>
                  <a class="navbar-item" href="https://jpastreamer.org">Website</a>
                  <a class="navbar-item" href="https://github.com/speedment/jpa-streamer">GitHub</a>
              </div>
          </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="jpa-streamer" data-version="3.0.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../introduction/introduction.html">Introduction</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../why-jpastreamer/why-jpastreamer.html">Why JPAstreamer?</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../how-it-works/how-it-works.html">How JPAstreamer Works</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../quick-start/quick-start.html">Quick-start with JPAstreamer</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-text">Get JPAstreamer</span>
    <button class="nav-item-toggle"></button>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../get-jpa-streamer/install-maven.html">Install with Maven</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../get-jpa-streamer/install-gradle.html">Install with Gradle</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../get-jpa-streamer/spring_integration.html">Spring Integration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../get-jpa-streamer/cdi_integration.html">CDI Integration</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../predicates/predicates.html">Predicates</a>
    <button class="nav-item-toggle"></button>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../predicates/reference-predicates.html">Reference Predicates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../predicates/comparable-predicates.html">Comparable Predicates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../predicates/string-predicates.html">String Predicates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../predicates/primitive-predicates.html">Primitive Predicates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../predicates/negating-predicates.html">Negating Predicates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../predicates/combining-predicates.html">Combining Predicates</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="stream_basics.html">Stream Fundamentals</a>
    <button class="nav-item-toggle"></button>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="intermediate_operations.html">Intermediate Operations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="terminal_operations.html">Terminal Operations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="other_operations.html">Other Operations</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../fetching-data/fetching-data.html">Fetching Data</a>
    <button class="nav-item-toggle"></button>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../fetching-data/sql-equivalents.html">SQL Equivalents</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../fetching-data/stream-examples.html">Stream Examples</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../transactions/transactions.html">Transactions</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">JPAStreamer Docs</span>
    <span class="version">3.0.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">JPAStreamer Docs</span>
      <ul class="versions">
        <li class="version">
          <a href="../../latest/introduction/introduction.html">3.0.3</a>
        </li>
        <li class="version">
          <a href="../../3.0.2/introduction/introduction.html">3.0.2</a>
        </li>
        <li class="version">
          <a href="../../3.0.1/introduction/introduction.html">3.0.1</a>
        </li>
        <li class="version is-current">
          <a href="../introduction/introduction.html">3.0.0</a>
        </li>
        <li class="version">
          <a href="../../1.1.4/introduction/introduction.html">1.1.4</a>
        </li>
        <li class="version">
          <a href="../../1.1.3/introduction/introduction.html">1.1.3</a>
        </li>
        <li class="version">
          <a href="../../1.1.2/introduction/introduction.html">1.1.2</a>
        </li>
        <li class="version">
          <a href="../../1.1.0/introduction/introduction.html">1.1.0</a>
        </li>
        <li class="version">
          <a href="../../1.0.2/introduction/introduction.html">1.0.2</a>
        </li>
        <li class="version">
          <a href="../../1.0.1/introduction/introduction.html">1.0.1</a>
        </li>
        <li class="version">
          <a href="../../1.0.0/introduction/introduction.html">1.0.0</a>
        </li>
        <li class="version">
          <a href="../../0.1.8/introduction/introduction.html">0.1.8</a>
        </li>
        <li class="version">
          <a href="../../0.1.7/introduction/introduction.html">0.1.7</a>
        </li>
        <li class="version">
          <a href="../../0.1.6/introduction/introduction.html">0.1.6</a>
        </li>
        <li class="version">
          <a href="../../0.1.5/introduction/introduction.html">0.1.5</a>
        </li>
        <li class="version">
          <a href="../../0.1.4/introduction/introduction.html">0.1.4</a>
        </li>
        <li class="version">
          <a href="../../0.1.3/introduction/introduction.html">0.1.3</a>
        </li>
        <li class="version">
          <a href="../../0.1.2/introduction/introduction.html">0.1.2</a>
        </li>
        <li class="version">
          <a href="../../0.1.0/introduction/introduction.html">0.1.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
</div>
  <div class="content">
<article class="doc">
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../introduction/introduction.html">JPAStreamer Docs</a></li>
    <li><a href="stream_basics.html">Stream Fundamentals</a></li>
  </ul>
</nav>
<h1 class="page">Stream Fundamentals</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>JPAstreamer is all about Java 8 Streams that allow you to process data in a declarative manner similar to using SQL statements. If you are not yet familiar with the concept of <code>Streams</code>, you are encouraged to read this chapter carefully. Although, if you are comfortable with the use of <code>Stream</code>, feel free to skip directly to the <a href="../fetching-data/sql-equivalents.html" class="xref page">next chapter</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_what_is_a_stream"><a class="anchor" href="#_what_is_a_stream"></a>What is a Stream?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A Java 8 <code>Stream</code> is an <code>interface</code> with implementations that support functional style operations on a stream of elements. The entire Java Collection framework was retrofitted with <code>Stream</code> support in Java 8.</p>
</div>
<div class="paragraph">
<p>Streams can be used to express a kind of “recipe“ style of operations, allowing us to compose a number of function. The functions are applied to the elements in the <code>Stream</code> only when the <code>Stream</code> is “started“. A <code>Stream</code> recipe says <strong>what to do</strong> but generally <strong>not how to do it</strong> which is good from an abstraction point of view. This means that <code>Streams</code> can be very efficient and general.</p>
</div>
<div class="paragraph">
<p>Consider the following simple example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Stream.of( <i class="conum" data-value="1"></i><b>(1)</b>
        "Zlatan",
        "Tim",
        "Bo",
        "George",
        "Adam",
        "Oscar"
        )
        .filter(n -&gt; n.length() &gt; 2) <i class="conum" data-value="2"></i><b>(2)</b>
        .sorted() <i class="conum" data-value="3"></i><b>(3)</b>
        .collect(Collectors.toList()); <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Creates a <code>Stream</code> with the given content</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Retains only those <code>Strings</code> that are longer than 2 characters (i.e. "Bo" is dropped)</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Sorts the remaining <code>Strings</code> in natural order</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Collects the remaining sorted <code>Strings</code> in a <code>List</code></td>
</tr>
</table>
</div>
<div id="img-stream-pipeline" class="imageblock">
<div class="content">
<img src="_images/stream_pipeline.png" alt="Stream Pipeline">
</div>
<div class="title">A visual representation of the Stream pipeline.</div>
</div>
<div class="paragraph">
<p>It starts by creating a Stream using the statement Stream.of(). Note that nothing happens with the <code>Stream</code> at this point. This yields a <code>Stream</code> which can be used to further build a “recipe” around. By adding <code>filter()</code> only Strings that are longer than two characters will be included. Again, the <code>Stream</code> is not started, this only tells the <code>Stream</code> that when it starts, the Strings should be filtered. Next, a <code>sorted()</code> operator is added to the <code>Stream</code> recipe (more formally called a <code>Stream</code> pipeline). This means that when the <code>Stream</code> is started, all Strings that passes the filter shall be sorted in natural order. Again, nothing is flowing through the <code>Stream</code>.</p>
</div>
<div class="paragraph">
<p>The last operation to be added is <code>collect()</code>. This operation is different to all the previous operations in the way that it is a Terminal operation. Whenever a Terminal operation is applied to a <code>Stream</code>, the <code>Stream</code> cannot accept additional operations to its pipeline. It also means that the <code>Stream</code> is started.</p>
</div>
<div class="paragraph">
<p>It shall be noted that elements in a <code>Stream</code> are pulled by the Terminal operation (i.e. the collect operation) and not pushed by the <code>Stream</code>-source. So, <code>collect()</code> asks for the first element and that request then traverse up to the <code>Stream</code>-source that will provide the first element “Zlatan”. The <code>filter()</code> operator will check if the length of “Zlatan” is greater than two (which it is) and will then propagate “Zlatan” to the <code>sorted()</code> operator. Because the <code>sorted()</code> operation needs to see all Strings before it can decide on its output order, it will ask the <code>Stream</code>-source for all its remaining elements which, via the filter, is sent down the <code>Stream</code>. Once all Strings are received by the <code>sorted()</code> operator, it will sort the Strings and then output its first element (i.e. “Adam”) to the <code>collect()</code> operator. The result of the entire <code>Stream</code> pipeline will thus be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">"Adam", "George", "Oscar", "Tim", "Zlatan"</code></pre>
</div>
</div>
<div id="img-stream-basics" class="imageblock">
<div class="content">
<img src="_images/stream_basics_1.png" alt="Stream Pipeline">
</div>
<div class="title">A Stream consists of a source followed by a pipeline of an arbitrary number of intermediate operations and a terminal operation.</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_streams_with_jpastreamer"><a class="anchor" href="#_streams_with_jpastreamer"></a>Streams with JPAstreamer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>With JPAstreamer, it is possible to use the same Stream semantics to operate on JPA Entities. In that case, database rows are streamed rather than Strings (as shown in the example above). This way, database tables can be viewed as pure Java Streams as shown hereunder:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">jpaStreamer.stream(Film.class) <i class="conum" data-value="1"></i><b>(1)</b>
    .map(Film$.title) <i class="conum" data-value="2"></i><b>(2)</b>
    .filter(s -&gt; s.length() &gt; 4) <i class="conum" data-value="3"></i><b>(3)</b>
    .sorted() <i class="conum" data-value="4"></i><b>(4)</b>
    .collect(Collectors.toList()); <i class="conum" data-value="5"></i><b>(5)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Creates a <code>Stream</code> of films from a database table represented by a JPA Entity called Film</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Extract the title (a `String) from a Film using the automatically generated field Film$</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Retains only those <code>Strings</code> that are longer than four characters (i.e. "Jaws" is dropped)</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Sorts the remaining <code>Strings</code> in natural order</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Collects the remaining sorted <code>Strings</code> in a <code>List</code></td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Since <code>Stream</code> is an interface, JPAstreamer can select from a variety of different implementations of a <code>Stream</code> depending on the pipeline that is used and other factors. The Stream described above is rendered to a database query through JPA.
</td>
</tr>
</table>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="../predicates/combining-predicates.html">Combining Predicates</a></span>
  <span class="next"><a href="intermediate_operations.html">Intermediate Operations</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>© 2020 Speedment, Inc. All rights reserved.</p>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
    <script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>

  </body>
</html>
